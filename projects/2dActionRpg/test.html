<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <link rel="stylesheet" href="https://jmobleyworks.github.io/Assets/Css/mobleysoftGameTome.css">
</head>
<body>
<script>
const createElement=(t,p={},r=document.body)=>{const e=document.createElement(t);Object.assign(e,p);r.appendChild(e);return e;};const device=createElement('div',{id:'device'});const screen=createElement('div',{id:'screen'},device);const canvas=createElement('canvas',{id:'gameCanvas',width:256,height:224},screen);const resizeCanvas=()=>{const aspectRatio=256/224;let w=window.innerWidth,h=window.innerHeight;if(w/h>aspectRatio)w=h*aspectRatio;else h=w/aspectRatio;canvas.style.width=`${w}px`;canvas.style.height=`${h}px`;};window.addEventListener('resize',resizeCanvas);resizeCanvas();const createButton=(id,x,y,onStart,onEnd,p=document.body)=>{const btn=createElement('div',{className:'button',id,style:`left:${x};top:${y};`,innerText:id.toUpperCase()},p);let lt=0;const hs=e=>{e.preventDefault();const ct=new Date().getTime(),tl=ct-lt;lt=ct;ir=tl<300;onStart();mi=setInterval(onStart,ir?50:100);},he=e=>{e.preventDefault();clearInterval(mi);onEnd();};btn.addEventListener('touchstart',hs);btn.addEventListener('touchend',he);btn.addEventListener('mousedown',hs);btn.addEventListener('mouseup',he);};const controlsContainer=createElement('div',{style:'position:absolute;width:100%;height:100%;'},device);const dpad=createElement('div',{id:'dpad'},controlsContainer);createButton('up','0','-50px',()=>movePlayer(0,-ms),()=>{},dpad);createButton('down','0','50px',()=>movePlayer(0,ms),()=>{},dpad);createButton('left','-50px','0',()=>movePlayer(-ms,0),()=>{},dpad);createButton('right','50px','0',()=>movePlayer(ms,0),()=>{},dpad);const actionsContainer=createElement('div',{className:'actions'},controlsContainer);createButton('h','0','0',()=>attack(2,'thrust'),()=>{},actionsContainer);createButton('j','50px','0',()=>attack(3,'quarter'),()=>{},actionsContainer);createButton('k','100px','0',()=>attack(4,'half'),()=>{},actionsContainer);createButton('l','150px','0',()=>attack(5,'full'),()=>{},actionsContainer);const c=document.getElementById('gameCanvas'),ctx=c.getContext('2d'),ps=2,smMax=100,smRegen=0.5,lifeMax=3;let px=128,py=112,ex=Math.random()*256,ey=Math.random()*224,es=2,ms=2,sm=smMax,pl=lifeMax,el=lifeMax,as=null,dir='right',playerColor='white',enemyColor='red',enemySpeed=0.5;const draw=()=>{ctx.fillStyle='black';ctx.fillRect(0,0,c.width,c.height);ctx.fillStyle=playerColor;ctx.fillRect(px,py,ps,ps);ctx.fillStyle=enemyColor;ctx.fillRect(ex,ey,es,es);ctx.fillStyle='yellow';ctx.fillRect(10,10,sm,5);ctx.fillStyle='green';ctx.fillRect(10,20,pl*30,5);ctx.fillStyle='green';ctx.fillRect(246-el*30,20,el*30,5);if(as){ctx.fillStyle='yellow';switch(dir){case'up':ctx.fillRect(px,py-ps*as.multiplier,ps,ps*as.multiplier);break;case'down':ctx.fillRect(px,py,ps,ps*as.multiplier);break;case'left':ctx.fillRect(px-ps*as.multiplier,py,ps*as.multiplier,ps);break;case'right':ctx.fillRect(px,py,ps*as.multiplier,ps);break;}}};const update=()=>{sm=Math.min(sm+smRegen,smMax);draw();moveEnemy();checkCollision();requestAnimationFrame(update);if(as&&Date.now()-as.start>200)as=null;playerColor='white';enemyColor='red';};const movePlayer=(dx,dy)=>{px=Math.max(0,Math.min(256-ps,px+dx));py=Math.max(0,Math.min(224-ps,py+dy));if(dx>0)dir='right';else if(dx<0)dir='left';else if(dy>0)dir='down';else if(dy<0)dir='up';};window.addEventListener('keydown',(e)=>{if(e.key==='ArrowUp'||e.key==='w')movePlayer(0,-ms);else if(e.key==='ArrowDown'||e.key==='s')movePlayer(0,ms);else if(e.key==='ArrowLeft'||e.key==='a')movePlayer(-ms,0);else if(e.key==='ArrowRight'||e.key==='d')movePlayer(ms,0);else if(['h','z'].includes(e.key))attack(2,'thrust');else if(['j','x'].includes(e.key))attack(3,'quarter');else if(['k','c'].includes(e.key))attack(4,'half');else if(['l','v'].includes(e.key))attack(5,'full');});const attack=(multiplier,type)=>{if(sm>=multiplier){as={multiplier,start:Date.now(),type};sm-=multiplier;const knockback=()=>{let dx=0,dy=0;if(dir==='up')dy=-20;else if(dir==='down')dy=20;else if(dir==='left')dx=-20;else if(dir==='right')dx=20;ex=Math.max(0,Math.min(256-es,ex+dx));ey=Math.max(0,Math.min(224-es,ey+dy));};if(checkHit(ex,ey,px,py,ps,multiplier)){el--;enemyColor='blue';knockback();if(el<=0)console.log('Enemy defeated!');}if(checkHit(px,py,ex,ey,es,multiplier)){pl--;playerColor='blue';if(pl<=0)console.log('Player defeated!');}}};const checkHit=(tx,ty,x,y,size,multiplier)=>{switch(dir){case'up':return x<tx+size&&x+size>tx&&y-size*multiplier<ty+size&&y>ty;case'down':return x<tx+size&&x+size>tx&&y<ty+size&&y+size*multiplier>ty;case'left':return x-size*multiplier<tx+size&&x>tx&&y<ty+size&&y+size>ty;case'right':return x<tx+size&&x+size*multiplier>tx&&y<ty+size&&y+size>ty;}};const moveEnemy=()=>{let dx=px-ex,dy=py-ey,dist=Math.sqrt(dx*dx+dy*dy);if(dist>0){dx/=dist;dy/=dist;}ex=Math.max(0,Math.min(256-es,ex+dx*enemySpeed));ey=Math.max(0,Math.min(224-es,ey+dy*enemySpeed));};const checkCollision=()=>{if(px<ex+es&&px+ps>ex&&py<ey+es&&py+ps>ey){pl--;playerColor='red';if(pl<=0)console.log('Player defeated!');}};update();
</script>
</body>
</html>
